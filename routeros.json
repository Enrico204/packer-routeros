{
  "variables": {
    "ros_ver": "6.39.3"
  },
  "builders": [
    {
      "type": "virtualbox-iso",
      "vm_name": "routeros",
      "guest_os_type": "Other",
      "disk_size": "256",
      "vboxmanage": [
        ["modifyvm", "{{.Name}}", "--memory", "128"],
        ["modifyvm", "{{.Name}}", "--acpi", "on"],
        ["modifyvm", "{{.Name}}", "--ioapic", "on"],
        ["modifyvm", "{{.Name}}", "--hpet", "on"],
        ["modifyvm", "{{.Name}}", "--rtcuseutc", "on"],
        ["modifyvm", "{{.Name}}", "--pae", "on"],
        ["modifyvm", "{{.Name}}", "--usb", "on"],
        ["modifyvm", "{{.Name}}", "--usbehci", "off"],
        ["modifyvm", "{{.Name}}", "--nic2", "hostonly", "--hostonlyadapter2", "vboxnet0", "--cableconnected2", "on"]
      ],
      "iso_url": "https://download2.mikrotik.com/routeros/{{user `ros_ver`}}/mikrotik-{{user `ros_ver`}}.iso",
      "iso_checksum_type": "none",
      "http_directory": ".",
      "boot_command": [
        "ainy<wait10><enter>",
        "<wait10><wait10>",
        "admin<enter><wait><wait>",
        "<enter><wait><wait>",
        "n<wait><wait>",
        "<enter><wait5>",
        "/ip dhcp-client add disabled=no interface=ether1 add-default-route=no use-peer-dns=no use-peer-ntp=no<enter>",
        "<wait5>",
        "/tool fetch url=\"http://{{ .HTTPIP }}:{{ .HTTPPort }}/provision.rsc\" keep-result=yes dst-path=\"provision.rsc\"<enter>",
        "<wait5>",
        "/tool fetch url=\"http://{{ .HTTPIP }}:{{ .HTTPPort }}/vagrant_insecure.key\" keep-result=yes dst-path=\"vagrant.key\"<enter>",
        "<wait5>",
        "/import pr<tab><enter>",
        "<wait5>"
      ],
      "guest_additions_mode": "disable",
      "virtualbox_version_file": "",
      "ssh_username": "admin",
      "ssh_password": "",
      "ssh_wait_timeout": "60s",
      "shutdown_command": "execute \"/system shutdown\"",
      "format": "ova"
    }
  ],
  "post-processors": [
    {
      "type": "vagrant",
      "keep_input_artifact": false,
      "compression_level": 9,
      "output": "build/boxes/routeros.box",
      "vagrantfile_template": "vagrantfile-mikrotik.template"
    }
  ]
}